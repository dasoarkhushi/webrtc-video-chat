{"ast":null,"code":"import React,{useRef,useState}from\"react\";import io from\"socket.io-client\";import\"./App.css\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const socket=io(\"https://webrtc-video-chat-c0cu.onrender.com\");function App(){const[roomId,setRoomId]=useState(\"\");const[joined,setJoined]=useState(false);const[audioOn,setAudioOn]=useState(true);const[videoOn,setVideoOn]=useState(true);const[message,setMessage]=useState(\"\");const localVideoRef=useRef(null);const remoteVideoRef=useRef(null);const peerConnection=useRef(null);const localStream=useRef(null);const config={iceServers:[{urls:\"stun:stun.l.google.com:19302\"}]};const toggleAudio=()=>{if(!localStream.current)return;localStream.current.getAudioTracks().forEach(track=>{track.enabled=!track.enabled;});setAudioOn(prev=>!prev);};const toggleVideo=()=>{if(!localStream.current)return;localStream.current.getVideoTracks().forEach(track=>{track.enabled=!track.enabled;});setVideoOn(prev=>!prev);};const joinRoom=async()=>{if(!roomId.trim())return;if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){alert(\"Browser does not support media devices.\");return;}try{setJoined(true);socket.emit(\"join\",roomId);localStream.current=await navigator.mediaDevices.getUserMedia({video:true,audio:true});localVideoRef.current.srcObject=localStream.current;socket.on(\"ready\",async()=>{setMessage(\"Another user has joined the room.\");peerConnection.current=createPeerConnection();localStream.current.getTracks().forEach(track=>peerConnection.current.addTrack(track,localStream.current));const offer=await peerConnection.current.createOffer();await peerConnection.current.setLocalDescription(offer);socket.emit(\"offer\",offer,roomId);});socket.on(\"offer\",async offer=>{peerConnection.current=createPeerConnection();await peerConnection.current.setRemoteDescription(new RTCSessionDescription(offer));localStream.current.getTracks().forEach(track=>peerConnection.current.addTrack(track,localStream.current));const answer=await peerConnection.current.createAnswer();await peerConnection.current.setLocalDescription(answer);socket.emit(\"answer\",answer,roomId);});socket.on(\"answer\",answer=>peerConnection.current.setRemoteDescription(new RTCSessionDescription(answer)));socket.on(\"ice-candidate\",candidate=>peerConnection.current.addIceCandidate(new RTCIceCandidate(candidate)));}catch(error){console.error(error);alert(\"Permission denied or media devices error.\");}};const createPeerConnection=()=>{const pc=new RTCPeerConnection(config);pc.onicecandidate=e=>{if(e.candidate){socket.emit(\"ice-candidate\",e.candidate,roomId);}};pc.ontrack=e=>{remoteVideoRef.current.srcObject=e.streams[0];};return pc;};return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Peer-to-Peer Video Chat\"}),!joined?/*#__PURE__*/_jsxs(\"div\",{className:\"join-section\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Enter Room ID\",value:roomId,onChange:e=>setRoomId(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{onClick:joinRoom,children:\"Join\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[message&&/*#__PURE__*/_jsx(\"p\",{className:\"message\",children:message}),/*#__PURE__*/_jsxs(\"div\",{className:\"video-grid\",children:[/*#__PURE__*/_jsx(\"video\",{ref:localVideoRef,autoPlay:true,muted:true,playsInline:true}),/*#__PURE__*/_jsx(\"video\",{ref:remoteVideoRef,autoPlay:true,playsInline:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"control-panel\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:toggleAudio,children:audioOn?\"Mute Audio\":\"Unmute Audio\"}),/*#__PURE__*/_jsx(\"button\",{onClick:toggleVideo,children:videoOn?\"Turn Off Video\":\"Turn On Video\"})]})]})]});}export default App;","map":{"version":3,"names":["React","useRef","useState","io","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","socket","App","roomId","setRoomId","joined","setJoined","audioOn","setAudioOn","videoOn","setVideoOn","message","setMessage","localVideoRef","remoteVideoRef","peerConnection","localStream","config","iceServers","urls","toggleAudio","current","getAudioTracks","forEach","track","enabled","prev","toggleVideo","getVideoTracks","joinRoom","trim","navigator","mediaDevices","getUserMedia","alert","emit","video","audio","srcObject","on","createPeerConnection","getTracks","addTrack","offer","createOffer","setLocalDescription","setRemoteDescription","RTCSessionDescription","answer","createAnswer","candidate","addIceCandidate","RTCIceCandidate","error","console","pc","RTCPeerConnection","onicecandidate","e","ontrack","streams","className","children","type","placeholder","value","onChange","target","onClick","ref","autoPlay","muted","playsInline"],"sources":["C:/Users/dasoa/Downloads/webrtc-hiring-final-complete (2)/frontend/src/App.js"],"sourcesContent":["import React, { useRef, useState } from \"react\";\nimport io from \"socket.io-client\";\nimport \"./App.css\";\n\nconst socket = io(\"https://webrtc-video-chat-c0cu.onrender.com\");\n\nfunction App() {\n  const [roomId, setRoomId] = useState(\"\");\n  const [joined, setJoined] = useState(false);\n  const [audioOn, setAudioOn] = useState(true);\n  const [videoOn, setVideoOn] = useState(true);\n  const [message, setMessage] = useState(\"\");\n\n  const localVideoRef = useRef(null);\n  const remoteVideoRef = useRef(null);\n  const peerConnection = useRef(null);\n  const localStream = useRef(null);\n\n  const config = {\n    iceServers: [{ urls: \"stun:stun.l.google.com:19302\" }],\n  };\n\n  const toggleAudio = () => {\n    if (!localStream.current) return;\n    localStream.current.getAudioTracks().forEach(track => {\n      track.enabled = !track.enabled;\n    });\n    setAudioOn(prev => !prev);\n  };\n\n  const toggleVideo = () => {\n    if (!localStream.current) return;\n    localStream.current.getVideoTracks().forEach(track => {\n      track.enabled = !track.enabled;\n    });\n    setVideoOn(prev => !prev);\n  };\n\n  const joinRoom = async () => {\n    if (!roomId.trim()) return;\n    if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\n      alert(\"Browser does not support media devices.\");\n      return;\n    }\n\n    try {\n      setJoined(true);\n      socket.emit(\"join\", roomId);\n\n      localStream.current = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });\n      localVideoRef.current.srcObject = localStream.current;\n\n      socket.on(\"ready\", async () => {\n        setMessage(\"Another user has joined the room.\");\n        peerConnection.current = createPeerConnection();\n        localStream.current.getTracks().forEach(track =>\n          peerConnection.current.addTrack(track, localStream.current)\n        );\n        const offer = await peerConnection.current.createOffer();\n        await peerConnection.current.setLocalDescription(offer);\n        socket.emit(\"offer\", offer, roomId);\n      });\n\n      socket.on(\"offer\", async (offer) => {\n        peerConnection.current = createPeerConnection();\n        await peerConnection.current.setRemoteDescription(new RTCSessionDescription(offer));\n        localStream.current.getTracks().forEach(track =>\n          peerConnection.current.addTrack(track, localStream.current)\n        );\n        const answer = await peerConnection.current.createAnswer();\n        await peerConnection.current.setLocalDescription(answer);\n        socket.emit(\"answer\", answer, roomId);\n      });\n\n      socket.on(\"answer\", answer =>\n        peerConnection.current.setRemoteDescription(new RTCSessionDescription(answer))\n      );\n\n      socket.on(\"ice-candidate\", candidate =>\n        peerConnection.current.addIceCandidate(new RTCIceCandidate(candidate))\n      );\n    } catch (error) {\n      console.error(error);\n      alert(\"Permission denied or media devices error.\");\n    }\n  };\n\n  const createPeerConnection = () => {\n    const pc = new RTCPeerConnection(config);\n    pc.onicecandidate = e => {\n      if (e.candidate) {\n        socket.emit(\"ice-candidate\", e.candidate, roomId);\n      }\n    };\n    pc.ontrack = e => {\n      remoteVideoRef.current.srcObject = e.streams[0];\n    };\n    return pc;\n  };\n\n  return (\n    <div className=\"container\">\n      <h2>Peer-to-Peer Video Chat</h2>\n      {!joined ? (\n        <div className=\"join-section\">\n          <input\n            type=\"text\"\n            placeholder=\"Enter Room ID\"\n            value={roomId}\n            onChange={(e) => setRoomId(e.target.value)}\n          />\n          <button onClick={joinRoom}>Join</button>\n        </div>\n      ) : (\n        <>\n          {message && <p className=\"message\">{message}</p>}\n          <div className=\"video-grid\">\n            <video ref={localVideoRef} autoPlay muted playsInline></video>\n            <video ref={remoteVideoRef} autoPlay playsInline></video>\n          </div>\n          <div className=\"control-panel\">\n            <button onClick={toggleAudio}>{audioOn ? \"Mute Audio\" : \"Unmute Audio\"}</button>\n            <button onClick={toggleVideo}>{videoOn ? \"Turn Off Video\" : \"Turn On Video\"}</button>\n          </div>\n        </>\n      )}\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}